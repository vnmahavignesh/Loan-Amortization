<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Amortization Calculator</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>

<body>
    <!-- Full-width Loan Inputs Banner -->
    <div class="loan-inputs-banner">
        <h1>üí∞ Loan Amortization Calculator</h1>
        <h3 class="section-subtitle">üìù Loan Details</h3>
        <div class="input-grid">
            <div class="input-item">
                <label class="input-label">Loan Amount (‚Çπ)</label>
                <input type="text" id="loanAmountInput" class="input-field" placeholder="e.g 1000000" min="1" step="1"
                    pattern="[0-9]*">
                <div class="error-message" id="loanAmountError">Please enter positive integers only</div>
            </div>
            <div class="input-item">
                <label class="input-label">Interest Rate (% p.a.)</label>
                <input type="text" step="0.01" id="rateInput" class="input-field" placeholder="e.g 8.55" min="0.01">
                <div class="error-message" id="rateInputError">Please enter positive numbers only (e.g., 8.55 or 12.345)
                </div>
            </div>
            <div class="input-item">
                <label class="input-label">Total Tenure (months)</label>
                <input type="text" id="tenureInput" class="input-field" placeholder="e.g 60" min="1" step="1"
                    pattern="[0-9]*">
                <div class="error-message" id="tenureInputError">Please enter positive integers only</div>
            </div>
            <div class="input-item">
                <label class="input-label">Monthly EMI (‚Çπ)</label>
                <input type="text" id="emiInput" class="input-field" placeholder="e.g 36544" min="1" step="1"
                    pattern="[0-9]*">
                <div class="error-message" id="emiInputError">Please enter positive integers only</div>
                <div class="auto-calc-indicator" id="emiAutoCalcIndicator">Auto-calculated</div>
            </div>
        </div>
        <div class="button-container">
            <button class="generate-btn" onclick="generateTable()" id="generateTableBtn">üìä Generate Table</button>

            <button class="btn btn-save" onclick="saveData()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                    <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                Save Changes
            </button>

            <button class="btn btn-clear" onclick="clearAllData()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
                Clear All Data
            </button>

            <button class="btn btn-details" onclick="showPaymentDetailsPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                Payment Details
            </button>
        </div>

        <!-- Combined status container for both messages -->
        <div class="status-container">
            <!-- Unsaved changes indicator -->
            <div class="unsaved-indicator" id="unsavedIndicator">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z">
                    </path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <span>You have unsaved changes. Click "Save Changes" to persist your data.</span>
            </div>

            <!-- Save success status -->
            <div class="save-status" id="saveStatus">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
                <span>‚úì Changes saved successfully!</span>
            </div>
        </div>
    </div>

    <!-- Summary Section -->
    <div id="summarySection" class="outer-summary" style="display: none;">
        <div
            style="background: linear-gradient(135deg, #e0f7fa 0%, #fff9c4 100%); border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);">

            <!-- Compact 3-Column Layout -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">

                <!-- Column 1: Loan Summary -->
                <div
                    style="background: rgba(255,255,255,0.95); padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                    <h3
                        style="margin-bottom: 12px; color: #333; font-size: 1.1em; border-bottom: 2px solid #667eea; padding-bottom: 8px;">
                        üìä Loan Summary</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üíµ Loan Amount</span>
                            <span id="summaryLoanAmount"
                                style="color: #667eea; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üìÖ Tenure</span>
                            <span id="summaryTenure"
                                style="color: #764ba2; font-size: 1.1em; font-weight: 700;">0</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üí∞ Total Interest</span>
                            <span id="summaryTotalInterest"
                                style="color: #e74c3c; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üí≥ Total Amount</span>
                            <span id="summaryTotalAmount"
                                style="color: #f39c12; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                    </div>
                </div>

                <!-- Column 2: Savings Summary -->
                <div
                    style="background: rgba(255,255,255,0.95); padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                    <h3
                        style="margin-bottom: 12px; color: #333; font-size: 1.1em; border-bottom: 2px solid #27ae60; padding-bottom: 8px;">
                        üí∞ Savings Summary</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üí∞ Interest Saved</span>
                            <span id="interestSaved"
                                style="color: #27ae60; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">‚è±Ô∏è Time Saved</span>
                            <span id="timeSaved" style="color: #e74c3c; font-size: 1.1em; font-weight: 700;">0</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üíµ Total Pre-payment</span>
                            <span id="totalPrepayment"
                                style="color: #f39c12; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üìÖ Remaining Tenure</span>
                            <span id="remainingTenure"
                                style="color: #667eea; font-size: 1.1em; font-weight: 700;">0</span>
                        </div>
                    </div>
                </div>

                <!-- Column 3: Payment Details -->
                <div
                    style="background: rgba(255,255,255,0.95); padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                    <h3
                        style="margin-bottom: 12px; color: #333; font-size: 1.1em; border-bottom: 2px solid #f39c12; padding-bottom: 8px;">
                        üí≥ Payment Details</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üí∞ Interest Paid</span>
                            <span id="totalInterestPaid"
                                style="color: #e74c3c; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üíµ Principal Paid</span>
                            <span id="totalPrincipalPaid"
                                style="color: #667eea; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üí≥ Total EMI Paid</span>
                            <span id="totalEmiPaid"
                                style="color: #f39c12; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                            <span style="color: #666; font-size: 0.85em; font-weight: 600;">üìä Other Charges</span>
                            <span id="totalOtherCharges"
                                style="color: #9b59b6; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Additional Details Row (Less Important Metrics) -->
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 15px;">
                <div
                    style="background: rgba(255,255,255,0.9); padding: 10px 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06); display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #666; font-size: 0.8em; font-weight: 600;">üìÖ Prepayment Months</span>
                    <!-- CHANGED: Keep original prepayment link functionality -->
                    <span id="prepaymentMonths" class="prepayment-link" onclick="showPrepaymentDetailsPage()"
                        style="color: #2ecc71; font-size: 1em; font-weight: 700;">0</span>
                </div>
                <div
                    style="background: rgba(255,255,255,0.9); padding: 10px 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06); display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #666; font-size: 0.8em; font-weight: 600;">üìä Other Charges Months</span>
                    <!-- CHANGED: Keep original charges link functionality -->
                    <span id="chargesMonths" class="charges-link" onclick="showChargesDetailsPage()"
                        style="color: #9b59b6; font-size: 1em; font-weight: 700;">0</span>
                </div>
                <div
                    style="background: rgba(255,255,255,0.9); padding: 10px 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06); display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #666; font-size: 0.8em; font-weight: 600;">üíé New Total Interest</span>
                    <span id="newTotalInterest" style="color: #8e44ad; font-size: 1em; font-weight: 700;">‚Çπ0.00</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Amortization Table Container -->
    <div id="amortizationTableContainer" style="display: none;">
        <div class="year-filter-container" id="yearFilterContainer" style="display: none;">
            <button class="btn btn-export" onclick="exportAmortizationToCSV()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export to CSV
            </button>
            <div class="year-filter-controls">
                <label class="year-filter-label" style="color: rgb(244, 252, 244);">Filter by Year:</label>
                <select class="year-filter-select" id="yearFilterSelect" onchange="filterByYear()">
                    <option value="all">All Years</option>
                </select>
            </div>
        </div>

        <!-- Year Summary Section -->
        <div class="year-summary" id="yearSummary">
            <h3 style="margin-bottom: 15px; color: #333; font-size: 1.3em;" id="yearSummaryTitle">Year Summary</h3>
            <div class="year-summary-grid">
                <div class="year-summary-item">
                    <div class="year-summary-label">Total Principal Paid</div>
                    <div class="year-summary-value" id="yearPrincipalPaid">‚Çπ0.00</div>
                </div>
                <div class="year-summary-item">
                    <div class="year-summary-label">Total Interest Paid</div>
                    <div class="year-summary-value" id="yearInterestPaid">‚Çπ0.00</div>
                </div>
                <div class="year-summary-item">
                    <div class="year-summary-label">Total Pre-payments</div>
                    <div class="year-summary-value" id="yearPrepayments">‚Çπ0.00</div>
                </div>
                <div class="year-summary-item">
                    <div class="year-summary-label">Total Charges</div>
                    <div class="year-summary-value" id="yearCharges">‚Çπ0.00</div>
                </div>
                <div class="year-summary-item">
                    <div class="year-summary-label">Closing Balance</div>
                    <div class="year-summary-value" id="yearClosingBalance">‚Çπ0.00</div>
                </div>
            </div>
        </div>

        <div class="table-container">
            <table id="amortizationTable">
                <thead>
                    <tr>
                        <th>EMI Paid</th>
                        <th>Month</th>
                        <th>Opening Balance</th>
                        <th>Interest Rate (%)</th>
                        <th>Interest</th>
                        <th>Principal</th>
                        <th>EMI</th>
                        <th>Pre-payment</th>
                        <th>Other Charges</th>
                        <th>Closing Balance</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Payment Details Page -->
    <div id="paymentDetailsPage" class="payment-details-page">
        <div class="payment-details-header">
            <div>
                <h2 style="color: #333;">üí∞ Payment Details</h2>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 10px;">
                    <div
                        style="background: #e8f5e8; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Total Pre-payment:</span>
                        <span id="paymentPrepaymentTotalAmount"
                            style="color: #f39c12; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                    </div>
                    <div
                        style="background: #e8f5e8; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Pre-payment Months:</span>
                        <span id="paymentPrepaymentTotalMonths"
                            style="color: #667eea; font-size: 1.1em; font-weight: 700;">0</span>
                    </div>
                    <div
                        style="background: #f3e5f5; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Total Other Charges:</span>
                        <span id="paymentChargesTotalAmount"
                            style="color: #9b59b6; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                    </div>
                    <div
                        style="background: #f3e5f5; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Other Charges Months:</span>
                        <span id="paymentChargesTotalMonths"
                            style="color: #667eea; font-size: 1.1em; font-weight: 700;">0</span>
                    </div>
                </div>
            </div>
            <div class="payment-details-actions">
                <button class="btn btn-export" onclick="exportPaymentDetailsToCSV()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export to CSV
                </button>
                <button class="back-button" onclick="hidePaymentDetailsPage()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"></path>
                    </svg>
                    Back to Calculator
                </button>
            </div>
        </div>

        <div class="table-container">
            <table class="payment-details-table">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Pre-payment Amount</th>
                        <th>Pre-payment Date</th>
                        <th>Pre-payment Description</th>
                        <th>Other Charges</th>
                        <th>Other Charges Date</th>
                        <th>Other Charges Description</th>
                    </tr>
                </thead>
                <tbody id="paymentDetailsBody">
                    <!-- Payment details will be populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Prepayment Details Page -->
    <div id="prepaymentDetailsPage" class="prepayment-details-page">
        <div class="prepayment-details-header">
            <div>
                <h2 style="color: #333;">üìÖ Prepayment Details</h2>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <div
                        style="background: #e8f5e8; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Total Pre-payment:</span>
                        <span id="prepaymentTotalAmount"
                            style="color: #f39c12; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                    </div>
                    <div
                        style="background: #e8f5e8; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Total Months:</span>
                        <span id="prepaymentTotalMonths"
                            style="color: #667eea; font-size: 1.1em; font-weight: 700;">0</span>
                    </div>
                </div>
            </div>
            <div class="prepayment-details-actions">
                <button class="btn btn-export" onclick="exportPrepaymentDetailsToCSV()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export to CSV
                </button>
                <button class="back-button" onclick="hidePrepaymentDetailsPage()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"></path>
                    </svg>
                    Back to Calculator
                </button>
            </div>
        </div>

        <div class="table-container">
            <table class="prepayment-details-table">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Pre-payment Amount</th>
                        <th>Pre-payment Date</th>
                        <th>Pre-payment Description</th>
                    </tr>
                </thead>
                <tbody id="prepaymentDetailsBody">
                    <!-- Prepayment details will be populated here -->
                </tbody>
            </table>
        </div>

    </div>

    <!-- Charges Details Page -->
    <div id="chargesDetailsPage" class="charges-details-page">
        <div class="charges-details-header">
            <div>
                <h2 style="color: #333;">üìä Other Charges Details</h2>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <div
                        style="background: #f3e5f5; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Total Other Charges:</span>
                        <span id="chargesTotalAmount"
                            style="color: #9b59b6; font-size: 1.1em; font-weight: 700;">‚Çπ0.00</span>
                    </div>
                    <div
                        style="background: #f3e5f5; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="color: #666; font-size: 0.9em; font-weight: 600;">Total Months:</span>
                        <span id="chargesTotalMonths"
                            style="color: #667eea; font-size: 1.1em; font-weight: 700;">0</span>
                    </div>
                </div>
            </div>
            <div class="charges-details-actions">
                <button class="btn btn-export" onclick="exportChargesDetailsToCSV()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export to CSV
                </button>
                <button class="back-button" onclick="hideChargesDetailsPage()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"></path>
                    </svg>
                    Back to Calculator
                </button>
            </div>
        </div>

        <div class="table-container">
            <table class="charges-details-table">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Other Charges</th>
                        <th>Other Charges Date</th>
                        <th>Other Charges Description</th>
                    </tr>
                </thead>
                <tbody id="chargesDetailsBody">
                    <!-- Charges details will be populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Prepayment Manager Modal -->
    <div class="prepayment-manager-overlay" id="prepaymentManagerOverlay"></div>
    <div class="prepayment-manager" id="prepaymentManager">
        <div class="prepayment-manager-header">
            <h3 style="color: #333; margin: 0;">Manage Prepayments - Month <span id="prepaymentManagerMonth">1</span>
            </h3>
            <button class="back-button" onclick="hidePrepaymentManager()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"></path>
                </svg>
                Close
            </button>
        </div>

        <div class="prepayment-summary" id="prepaymentManagerSummary">
            Total Prepayments: ‚Çπ0.00
        </div>

        <div class="prepayment-list" id="prepaymentList">
            <!-- Prepayment items will be added here -->
        </div>

        <div class="add-prepayment-form">
            <input type="number" id="newPrepaymentAmount" placeholder="Amount (‚Çπ)" step="1" min="1" class="input-field">
            <input type="date" id="newPrepaymentDate" class="input-field">
            <input type="text" id="newPrepaymentDescription" placeholder="Description (optional)" class="input-field">
            <button class="btn btn-save btn-small" onclick="addPrepayment()">Add</button>
        </div>

        <div style="display: flex; justify-content: flex-end; gap: 10px;">
            <button class="btn btn-clear" onclick="clearAllPrepayments()">Clear All</button>
            <button class="btn btn-save" onclick="savePrepayments()">Save Changes</button>
        </div>
    </div>

    <!-- Charges Manager Modal -->
    <div class="charges-manager-overlay" id="chargesManagerOverlay"></div>
    <div class="charges-manager" id="chargesManager">
        <div class="charges-manager-header">
            <h3 style="color: #333; margin: 0;">Manage Other Charges - Month <span id="chargesManagerMonth">1</span>
            </h3>
            <button class="back-button" onclick="hideChargesManager()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"></path>
                </svg>
                Close
            </button>
        </div>

        <div class="charges-summary" id="chargesManagerSummary">
            Total Other Charges: ‚Çπ0.00
        </div>

        <div class="charges-list" id="chargesList">
            <!-- Charges items will be added here -->
        </div>

        <div class="add-charges-form">
            <input type="number" id="newChargesAmount" placeholder="Amount (‚Çπ)" step="1" min="1" class="input-field">
            <input type="date" id="newChargesDate" class="input-field">
            <input type="text" id="newChargesDescription" placeholder="Description (optional)" class="input-field">
            <button class="btn btn-save btn-small" onclick="addCharges()">Add</button>
        </div>

        <div style="display: flex; justify-content: flex-end; gap: 10px;">
            <button class="btn btn-clear" onclick="clearAllCharges()">Clear All</button>
            <button class="btn btn-save" onclick="saveCharges()">Save Changes</button>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/storage-manager.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/table-manager.js"></script>
    <script src="js/prepayment-manager.js"></script>
    <script src="js/charges-manager.js"></script>
    <script src="js/export-manager.js"></script>
    <script src="js/savings-calculator.js"></script>
    <script src="js/pages-manager.js"></script>
    <script src="js/main.js"></script>
</body>

</html>
